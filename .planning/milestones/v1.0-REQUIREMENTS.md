# Requirements Archive: v1.0 Robuste Flugsuche

**Archived:** 2026-02-02
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## REQ-001: LLM-basierte Airport-Extraktion
**Priority:** HIGH | **Status:** ✅ Complete

Ersetze die statische `airport-codes.ts` Mapping-Datei durch LLM-basierte Extraktion.

**Acceptance Criteria:**
- [x] xAI/Grok extrahiert IATA-Codes aus natürlicher Sprache
- [x] Kontext-Verständnis: "costa rica liberia" → LIR (nicht LIB)
- [x] Strukturierte Ausgabe via Vercel AI SDK
- [x] Fallback auf Duffel Places API wenn LLM unsicher

**Constraints:**
- Nutze bestehenden xAI/Grok Provider ✓
- Keine zusätzlichen LLM-Anbieter ✓
- Antwortzeit < 2s für Airport-Auflösung ✓

**Outcome:** Vollständig implementiert mit drei-stufiger Resolution (Direct → Static → LLM), 24h Cache, und 2-Sekunden Timeout.

---

## REQ-002: Alternative Flughäfen bei 0 Ergebnissen
**Priority:** MEDIUM | **Status:** ✅ Complete

Wenn Suche keine Treffer liefert, schlage automatisch nahegelegene Flughäfen vor.

**Acceptance Criteria:**
- [x] Nutze Duffel Places API für Nearby-Airports
- [x] Radius: 150km default (dynamisch je nach Region)
- [x] Zeige max 3 Alternativen
- [x] Klare UX: "Keine Flüge gefunden. Alternativen in der Nähe:"

**Outcome:** Vollständig implementiert mit Drive-Time Anzeige (~X,Xh Fahrt), interaktivem UI mit AlertDialog-Bestätigung, und Major-Hub-Heuristik.

---

## REQ-003: Flexible Datumssuche
**Priority:** LOW | **Status:** ✅ Complete

Bei 0 Ergebnissen optional +/- 3 Tage anbieten.

**Acceptance Criteria:**
- [x] Nutze bestehende Seats.aero date-range Funktion
- [x] Für Duffel: parallele Requests mit Rate-Limiting
- [x] User-Opt-in: "Auch andere Daten prüfen?"

**Outcome:** Vollständig implementiert mit FlexibleDateSelector Component, batched Duffel-Requests (max 3 concurrent), und nativer Seats.aero flexibility:3.

---

## REQ-004: Fehler-Monitoring
**Priority:** MEDIUM | **Status:** ✅ Complete

Tracke fehlgeschlagene Suchen für proaktive Verbesserung.

**Acceptance Criteria:**
- [x] Logge: Query, extrahierte Codes, Ergebnis-Count, Timestamp
- [x] Speichere in DB-Tabelle (PostgreSQL via Drizzle)
- [x] Einfaches Dashboard unter /admin/failed-searches

**Outcome:** Vollständig implementiert mit failedSearchLogs Tabelle, 30-Tag TTL, Vercel Cron Cleanup (täglich 2 AM UTC), und Admin UI mit Filterung.

---

## Out of Scope

- Buchungsfunktion (existiert bereits) — bestätigt außerhalb
- Neue Flug-APIs (Duffel + Seats.aero bleiben) — bestätigt
- UI-Redesign — bestätigt, nur Backend-Verbesserungen
- Multi-Language Support (Deutsch reicht) — bestätigt

---

## Traceability

| Requirement | Phase | Status | Outcome |
|-------------|-------|--------|---------|
| REQ-001 | Phase 1 | ✅ Complete | LLM extraction mit Cache + Timeout |
| REQ-002 | Phase 2 | ✅ Complete | Alternative airports mit Drive-Time UI |
| REQ-003 | Phase 3 | ✅ Complete | Flexible dates ±3 Tage |
| REQ-004 | Phase 3 | ✅ Complete | Failed search logging + Admin UI |

---

## Milestone Summary

**Shipped:** 4 of 4 v1.0 requirements
**Adjusted:** None
**Dropped:** None

---
*Archived: 2026-02-02 as part of v1.0 milestone completion*
