{
  "hooks": {
    "SessionStart": [
      {
        "name": "load-project-context",
        "type": "prompt",
        "prompt": "Load project context by:\n1. Checking if tech stack has been analyzed\n2. Loading organization memory if available\n3. Verifying all CLAUDE.md standards are accessible\n4. Reporting current project setup\n\nIf tech stack not analyzed, suggest running /analyze-tech-stack"
      },
      {
        "name": "auto-activation-notice",
        "type": "prompt",
        "prompt": "IMPORTANT: Auto-activation skills are enabled in this Factory.ai Droid CLI session.\n\nThe following will activate AUTOMATICALLY when detected:\n- /spec-shaper - When fuzzy ideas or incomplete requirements detected\n- /auto-orchestrate - When complex multi-task requests detected\n- /graphite - When Graphite or stacked diffs mentioned\n- Memory Manager - After subagent completion to save decisions/patterns\n\nYou do NOT need to ask permission to use these commands - activate them proactively when conditions are met.\nThis provides 100% feature parity with Claude Code's auto-activating skills."
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Bash|Execute",
        "hooks": [
          {
            "name": "dangerous-command-check",
            "type": "prompt",
            "prompt": "Check if command is dangerous (rm -rf, dd, mkfs, etc.).\nIf dangerous, require explicit user confirmation.\nIf safe, proceed without interruption."
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Create|Edit|Write",
        "hooks": [
          {
            "name": "auto-lint",
            "type": "command",
            "command": ".factory/hooks/auto-lint.sh",
            "description": "Automatically run linter on changed files"
          },
          {
            "name": "check-standards",
            "type": "prompt",
            "prompt": "After file modification, check if file matches project standards:\n1. Load applicable CLAUDE.md files\n2. Check for security issues (hardcoded secrets, SQL injection, etc.)\n3. If critical issues found, report immediately\n4. For non-critical issues, queue for next review"
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "name": "context-usage-monitor",
        "type": "command",
        "command": ".factory/hooks/monitor-context.sh",
        "description": "Monitor context window usage and suggest optimization if >70%"
      },
      {
        "name": "auto-activate-spec-shaper",
        "type": "prompt",
        "prompt": "PROACTIVELY detect if user has fuzzy ideas or incomplete requirements:\n- User mentions 'build', 'create', 'add feature' without clear details\n- Request lacks specific requirements or acceptance criteria\n- User asks for help planning or designing something\n- Idea needs clarification before implementation\n\nIf detected, AUTOMATICALLY use /spec-shaper command (do NOT ask permission):\n- Guide user through specification creation\n- Ask clarifying questions about requirements\n- Help define acceptance criteria\n- Create structured spec file\n\nActivate silently and proactively - this is auto-activation, not a suggestion."
      },
      {
        "name": "auto-activate-orchestrator",
        "type": "prompt",
        "prompt": "PROACTIVELY detect complex multi-task requests:\n- Request mentions 3+ distinct components or features\n- Multiple independent areas of work (frontend + backend + tests + infra)\n- User explicitly mentions parallel work or orchestration\n- Task estimated >2 hours with parallelizable components\n- Request involves different specialist domains\n\nIf detected, AUTOMATICALLY use /auto-orchestrate command (do NOT ask permission):\n- Analyze task complexity\n- Recommend orchestration approach\n- Break down into parallel tasks\n- Generate tasks.json if appropriate\n\nActivate silently and proactively - this is auto-activation, not a suggestion."
      },
      {
        "name": "auto-activate-graphite",
        "type": "prompt",
        "prompt": "PROACTIVELY detect Graphite stacked diffs usage:\n- User mentions 'stacked diffs', 'stacked PRs', 'Graphite', or 'gt' command\n- User asks about managing dependent pull requests\n- User wants to break large work into reviewable chunks\n- Context suggests multi-PR workflow needed\n\nIf detected, AUTOMATICALLY use /graphite command (do NOT ask permission):\n- Provide Graphite workflow guidance\n- Show relevant gt commands\n- Help with stack management\n- Guide through PR creation and syncing\n\nActivate silently and proactively - this is auto-activation, not a suggestion."
      }
    ],
    "SubagentStop": [
      {
        "name": "update-linear-ticket",
        "type": "prompt",
        "prompt": "If Linear MCP is available and task relates to a ticket:\n1. Check if PR was created\n2. Update ticket status to 'In Review' or 'Done'\n3. Add PR link as comment\n4. Update TodoWrite progress"
      },
      {
        "name": "auto-activate-memory-manager",
        "type": "prompt",
        "prompt": "PROACTIVELY detect and save important context after subagent completion:\n\nAUTOMATICALLY save to organization memory if:\n- Architectural decisions made (framework choices, patterns, structure)\n- Technical decisions (library selections, API designs, data models)\n- Project standards established\n- Build/deployment configurations chosen\n\nAUTOMATICALLY save to pattern library if:\n- New code pattern discovered or created\n- Reusable solution implemented\n- Best practice identified\n- Framework-specific pattern used\n\nAUTOMATICALLY save to user memory if:\n- User preferences expressed\n- Workflow preferences shown\n- Tool preferences indicated\n- Coding style preferences revealed\n\nUse /save-decision command for important decisions.\nActivate silently and proactively - this is auto-activation, not a suggestion.\n\nExample:\n- Decision: 'We chose PostgreSQL over MySQL for better JSON support'\n- Pattern: 'Repository pattern for database access'\n- Preference: 'User prefers TypeScript strict mode'"
      }
    ],
    "Notification": [
      {
        "matcher": "error|failed|exception",
        "hooks": [
          {
            "name": "error-analysis",
            "type": "prompt",
            "prompt": "When error notification received:\n1. Analyze error message and stack trace\n2. Check if similar error seen before (in memory)\n3. Suggest fix based on standards and patterns\n4. Save error pattern if novel"
          }
        ]
      }
    ],
    "Stop": [
      {
        "name": "session-summary",
        "type": "prompt",
        "prompt": "Before ending session:\n1. Summarize what was accomplished\n2. Note any incomplete tasks\n3. Save important decisions to memory\n4. Suggest next steps"
      }
    ]
  },
  "contextManagement": {
    "autoOptimize": true,
    "optimizationThreshold": 0.70,
    "aggressiveThreshold": 0.90,
    "createCheckpoints": true
  },
  "standards": {
    "enforcement": {
      "security": "block",
      "typescript": "warn",
      "performance": "suggest",
      "style": "auto-fix"
    },
    "autoFix": {
      "enabled": true,
      "requireApproval": false
    }
  },
  "memory": {
    "autoSave": true,
    "saveDecisions": true,
    "savePatterns": true,
    "savePreferences": true
  }
}
